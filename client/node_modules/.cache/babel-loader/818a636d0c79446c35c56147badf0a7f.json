{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\cblis\\\\OneDrive\\\\Documents\\\\Projects\\\\SBFE4\\\\client\\\\src\\\\components\\\\brew\\\\BrewPanel.tsx\",\n    _s = $RefreshSig$();\n\nimport { useContext, useEffect, useState } from \"react\";\nimport { WebSocketContext } from \"../../context/websocketContext\";\nimport { PowerLevelComponent } from \"./HeatControl\";\nimport { TemperatureDisplay } from \"./TempDisplay\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n// const initialState = new BrewControllerState();\nexport function BrewPanel(props) {\n  _s();\n\n  const {\n    controller\n  } = props;\n  const units = \"F\";\n  const {\n    socket\n  } = useContext(WebSocketContext);\n  const [controllerState, setControllerState] = useState({ ...controller,\n    temperature: \"--\",\n    powerLevel: 0\n  });\n  useEffect(() => {\n    console.log(\"controller useEffect loop\");\n    const updatedController = { ...controller,\n      powerLevel: controllerState.powerLevel\n    };\n    setControllerState(updatedController);\n  }, [controller]);\n\n  const adjustPowerLevel = adjustment => {\n    const updatedController = { ...controller\n    };\n    updatedController.powerLevel += adjustment;\n    if (updatedController.powerLevel > 100) updatedController.powerLevel = 100;else if (updatedController.powerLevel < 0) updatedController.powerLevel = 0;\n\n    if (socket !== undefined) {\n      socket.emit(\"brew:adjust\", updatedController, res => {\n        if (res !== undefined) {\n          if (\"error\" in res) {\n            console.log(res.error);\n            return;\n          }\n\n          const update = { ...controllerState,\n            powerLevel: res.data.powerLevel\n          };\n          console.log(`Power level set to ${update.powerLevel}`);\n          setControllerState(update);\n        }\n      });\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"d-inline-flex flex-column p-2 border \",\n    children: [/*#__PURE__*/_jsxDEV(TemperatureDisplay, {\n      temperature: controllerState.temperature,\n      units: units\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 60,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(PowerLevelComponent, {\n      powerLevel: controllerState.powerLevel,\n      adjustPowerLevel: adjustPowerLevel\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 64,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 59,\n    columnNumber: 5\n  }, this);\n}\n\n_s(BrewPanel, \"vbB9ldghx1Ls2X5RKWGQwfXli94=\");\n\n_c = BrewPanel;\n\nvar _c;\n\n$RefreshReg$(_c, \"BrewPanel\");","map":{"version":3,"sources":["C:/Users/cblis/OneDrive/Documents/Projects/SBFE4/client/src/components/brew/BrewPanel.tsx"],"names":["useContext","useEffect","useState","WebSocketContext","PowerLevelComponent","TemperatureDisplay","BrewPanel","props","controller","units","socket","controllerState","setControllerState","temperature","powerLevel","console","log","updatedController","adjustPowerLevel","adjustment","undefined","emit","res","error","update","data"],"mappings":";;;AAAA,SAASA,UAAT,EAAqBC,SAArB,EAAgCC,QAAhC,QAAgD,OAAhD;AAKA,SAASC,gBAAT,QAAiC,gCAAjC;AACA,SAASC,mBAAT,QAAoC,eAApC;AACA,SAASC,kBAAT,QAAmC,eAAnC;;AAMA;AAEA,OAAO,SAASC,SAAT,CAAmBC,KAAnB,EAAiC;AAAA;;AACtC,QAAM;AAAEC,IAAAA;AAAF,MAAiBD,KAAvB;AACA,QAAME,KAAK,GAAG,GAAd;AACA,QAAM;AAAEC,IAAAA;AAAF,MAAaV,UAAU,CAACG,gBAAD,CAA7B;AACA,QAAM,CAACQ,eAAD,EAAkBC,kBAAlB,IAAwCV,QAAQ,CAAsB,EAC1E,GAAGM,UADuE;AAE1EK,IAAAA,WAAW,EAAE,IAF6D;AAG1EC,IAAAA,UAAU,EAAE;AAH8D,GAAtB,CAAtD;AAMAb,EAAAA,SAAS,CAAC,MAAM;AACdc,IAAAA,OAAO,CAACC,GAAR,CAAY,2BAAZ;AACA,UAAMC,iBAAsC,GAAG,EAC7C,GAAGT,UAD0C;AAE7CM,MAAAA,UAAU,EAAEH,eAAe,CAACG;AAFiB,KAA/C;AAIAF,IAAAA,kBAAkB,CAACK,iBAAD,CAAlB;AACD,GAPQ,EAON,CAACT,UAAD,CAPM,CAAT;;AASA,QAAMU,gBAAgB,GAAIC,UAAD,IAAwB;AAC/C,UAAMF,iBAAiB,GAAG,EAAE,GAAGT;AAAL,KAA1B;AACAS,IAAAA,iBAAiB,CAACH,UAAlB,IAAgCK,UAAhC;AACA,QAAIF,iBAAiB,CAACH,UAAlB,GAA+B,GAAnC,EAAwCG,iBAAiB,CAACH,UAAlB,GAA+B,GAA/B,CAAxC,KACK,IAAIG,iBAAiB,CAACH,UAAlB,GAA+B,CAAnC,EAAsCG,iBAAiB,CAACH,UAAlB,GAA+B,CAA/B;;AAC3C,QAAIJ,MAAM,KAAKU,SAAf,EAA0B;AACxBV,MAAAA,MAAM,CAACW,IAAP,CAAY,aAAZ,EAA2BJ,iBAA3B,EAA+CK,GAAD,IAAS;AACrD,YAAIA,GAAG,KAAKF,SAAZ,EAAuB;AACrB,cAAI,WAAWE,GAAf,EAAoB;AAClBP,YAAAA,OAAO,CAACC,GAAR,CAAYM,GAAG,CAACC,KAAhB;AACA;AACD;;AACD,gBAAMC,MAA2B,GAAG,EAClC,GAAGb,eAD+B;AAElCG,YAAAA,UAAU,EAAEQ,GAAG,CAACG,IAAJ,CAASX;AAFa,WAApC;AAIAC,UAAAA,OAAO,CAACC,GAAR,CAAa,sBAAqBQ,MAAM,CAACV,UAAW,EAApD;AACAF,UAAAA,kBAAkB,CAACY,MAAD,CAAlB;AACD;AACF,OAbD;AAcD;AACF,GArBD;;AAuBA,sBACE;AAAK,IAAA,SAAS,EAAC,uCAAf;AAAA,4BACE,QAAC,kBAAD;AACE,MAAA,WAAW,EAAEb,eAAe,CAACE,WAD/B;AAEE,MAAA,KAAK,EAAEJ;AAFT;AAAA;AAAA;AAAA;AAAA,YADF,eAKE,QAAC,mBAAD;AACE,MAAA,UAAU,EAAEE,eAAe,CAACG,UAD9B;AAEE,MAAA,gBAAgB,EAAEI;AAFpB;AAAA;AAAA;AAAA;AAAA,YALF;AAAA;AAAA;AAAA;AAAA;AAAA,UADF;AAYD;;GAtDeZ,S;;KAAAA,S","sourcesContent":["import { useContext, useEffect, useState } from \"react\";\r\nimport {\r\n  BrewController,\r\n  BrewControllerState,\r\n} from \"../../../../server/lib/models/controllerModels\";\r\nimport { WebSocketContext } from \"../../context/websocketContext\";\r\nimport { PowerLevelComponent } from \"./HeatControl\";\r\nimport { TemperatureDisplay } from \"./TempDisplay\";\r\n\r\ninterface Props {\r\n  controller: BrewController;\r\n}\r\n\r\n// const initialState = new BrewControllerState();\r\n\r\nexport function BrewPanel(props: Props) {\r\n  const { controller } = props;\r\n  const units = \"F\";\r\n  const { socket } = useContext(WebSocketContext);\r\n  const [controllerState, setControllerState] = useState<BrewControllerState>({\r\n    ...controller,\r\n    temperature: \"--\",\r\n    powerLevel: 0,\r\n  });\r\n\r\n  useEffect(() => {\r\n    console.log(\"controller useEffect loop\");\r\n    const updatedController: BrewControllerState = {\r\n      ...controller,\r\n      powerLevel: controllerState.powerLevel,\r\n    };\r\n    setControllerState(updatedController);\r\n  }, [controller]);\r\n\r\n  const adjustPowerLevel = (adjustment: number) => {\r\n    const updatedController = { ...controller };\r\n    updatedController.powerLevel += adjustment;\r\n    if (updatedController.powerLevel > 100) updatedController.powerLevel = 100;\r\n    else if (updatedController.powerLevel < 0) updatedController.powerLevel = 0;\r\n    if (socket !== undefined) {\r\n      socket.emit(\"brew:adjust\", updatedController, (res) => {\r\n        if (res !== undefined) {\r\n          if (\"error\" in res) {\r\n            console.log(res.error);\r\n            return;\r\n          }\r\n          const update: BrewControllerState = {\r\n            ...controllerState,\r\n            powerLevel: res.data.powerLevel,\r\n          };\r\n          console.log(`Power level set to ${update.powerLevel}`);\r\n          setControllerState(update);\r\n        }\r\n      });\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"d-inline-flex flex-column p-2 border \">\r\n      <TemperatureDisplay\r\n        temperature={controllerState.temperature}\r\n        units={units}\r\n      />\r\n      <PowerLevelComponent\r\n        powerLevel={controllerState.powerLevel}\r\n        adjustPowerLevel={adjustPowerLevel}\r\n      />\r\n    </div>\r\n  );\r\n}\r\n"]},"metadata":{},"sourceType":"module"}